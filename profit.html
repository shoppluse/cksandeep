<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Profit Simulator</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gradient-to-br from-green-100 to-green-200 min-h-screen p-6">

<a href="index.html" class="text-green-700 font-semibold">‚Üê Back</a>

<h1 class="text-3xl font-bold mt-4 mb-2">üìä Profit Simulator</h1>
<p class="text-gray-600 mb-6" id="dishLabel">Selected Dish: Custom</p>

<div class="bg-white rounded-2xl shadow-xl p-6 max-w-3xl">

<!-- INPUTS -->
<div class="grid md:grid-cols-2 gap-4">
<input id="cost" type="number" class="border p-3 rounded-lg" placeholder="Cost per plate">
<input id="sell" type="number" class="border p-3 rounded-lg" placeholder="Selling price">
</div>

<button onclick="calc()" class="mt-4 bg-green-500 text-white px-6 py-3 rounded-xl hover:bg-green-600">
Calculate Profit
</button>

<!-- RESULT CARDS -->
<div class="grid md:grid-cols-3 gap-4 mt-6 text-center">

<div class="bg-green-100 p-4 rounded-xl">
<h3 class="text-lg">Profit</h3>
<p class="text-2xl font-bold">‚Çπ<span id="profit">0</span></p>
</div>

<div class="bg-green-100 p-4 rounded-xl">
<h3 class="text-lg">Margin</h3>
<p class="text-2xl font-bold"><span id="margin">0</span>%</p>
</div>

<div class="bg-green-100 p-4 rounded-xl">
<h3 class="text-lg">Monthly</h3>
<p class="text-2xl font-bold">‚Çπ<span id="monthly">0</span></p>
</div>

</div>

<!-- MONTHLY -->
<input id="orders" type="number" class="border p-3 rounded-lg mt-6 w-full" placeholder="Daily Orders">
<button onclick="monthlyCalc()" class="mt-3 bg-blue-500 text-white px-6 py-3 rounded-xl hover:bg-blue-600">
Estimate Monthly
</button>

<p class="mt-4 text-gray-600 text-sm">Tip: 40%+ margin is healthy for cloud kitchen</p>

</div>

<script>

/* LOAD SELECTED DISH + COST */
const savedCost = localStorage.getItem("selectedCost");
const savedDish = localStorage.getItem("selectedDish");

if(savedCost){
document.getElementById("cost").value = savedCost;
}

if(savedDish){
document.getElementById("dishLabel").innerText = "Selected Dish: " + savedDish;
}

let profitValue = 0;

/* PROFIT CALCULATION */
function calc(){
let c = Number(cost.value);
let s = Number(sell.value);

if(!c || !s){
alert("Enter cost and selling price");
return;
}

profitValue = s - c;
let marginValue = (profitValue / s) * 100;

profit.innerText = profitValue.toFixed(2);
margin.innerText = marginValue.toFixed(1);

/* AUTO SAVE CLEANLY */
let dish = savedDish || "Custom Dish";

let data = JSON.parse(localStorage.getItem("analysis") || "[]");

let existingIndex = data.findIndex(d => d.dish === dish);

let record = {
dish: dish,
cost: c,
price: s,
profit: profitValue,
margin: marginValue
};

if(existingIndex >= 0)
data[existingIndex] = record;
else
data.push(record);

localStorage.setItem("analysis", JSON.stringify(data));
}

/* MONTHLY PROFIT */
function monthlyCalc(){
let daily = Number(orders.value);
let monthlyProfit = profitValue * daily * 30;
monthly.innerText = monthlyProfit.toFixed(0);
}

</script>

</body>
</html>
